-- View all the columns and rows in the table
SELECT
    *
FROM
    studentseda
DELIMITER
    //
    -- Drop the unrelated tables for this analysis 
ALTER TABLE
    studentseda
DROP COLUMN
    FROM2,
DROP COLUMN
    FROM3,
DROP COLUMN
    FROM4,
DROP COLUMN
    Y,
DROP COLUMN
    Measure,
DROP COLUMN
    Functional_analysis
DELIMITER
    //
ALTER TABLE
    studentseda
DROP COLUMN
    from1
DELIMITER
    //
    -- Check for nulls and handle it appropriately if exist
SELECT
    ID,
    class,
    gender,
    race,
    GPA,
    Algebra,
    Calculus1,
    Calculus2,
    Statistics,
    Probability CASE WHEN ID IS NOT NULL THEN ID WHEN CLASS IS NOT NULL THEN class WHEN GENDER IS NOT NULL THEN gender WHEN RACE IS NOT NULL THEN race WHEN GPA IS NOT NULL THEN GPA WHEN ALGEBRA IS NOT NULL THEN Algebra WHEN CALCULUS1 IS NOT NULL THEN CALCULUS1 WHEN CALCULUS2 IS NOT NULL THEN Calculus2 WHEN STATISTICS IS NOT NULL THEN Statistics WHEN PROBABILITY IS NOT NULL THEN PROBABILITY ELSE 'N/A'
END AS cleaned_table
FROM
    studentseda
DELIMITER
    //
    -- Convert gender column content to proper letters
SELECT
    gender,
    CASE WHEN gender = 'male' THEN 'Male' WHEN gender = 'female' THEN 'Female' ELSE 'N/A'
END AS Changed_case
FROM
    studentseda
DELIMITER
    //
    -- What is the total number of students?
SELECT
    COUNT(*) AS total_number_of_students
FROM
    studentseda
DELIMITER
    //
    -- wHAT is the total no of race present?
SELECT
    COUNT(DISTINCT race) AS num_of_race
FROM
    studentseda
DELIMITER
    //
    -- What is the total number of students from each race
SELECT
    race,
    COUNT(race)
FROM
    studentseda
GROUP BY
    race
DELIMITER
    //
    -- What is the total number of each gender present
SELECT
    gender,
    COUNT(gender) AS num_of_each_gender
FROM
    studentseda
GROUP BY
    gender
Delimiter
    //
    -- Who scored the highest in Algebra?
SELECT
    id,
    class,
    gender,
    Algebra
FROM
    studentseda
WHERE
    Algebra =(
    SELECT
        MAX(Algebra)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the highest in Calculus1?
SELECT
    id,
    class,
    gender,
    Calculus1
FROM
    studentseda
WHERE
    Calculus1 =(
    SELECT
        MAX(calculus1)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the highest in Calculus2?
SELECT
    id,
    class,
    gender,
    Calculus2
FROM
    studentseda
WHERE
    calculus2 =(
    SELECT
        MAX(calculus2)
    FROM
        studentseda
)
DELIMITER
    //
    -- Who scored the highest in Statistics?
SELECT
    id,
    class,
    gender,
    Statistics
FROM
    studentseda
WHERE
    Statistics =(
    SELECT
        MAX(statistics)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the highest in Probability?
SELECT
    id,
    class,
    gender,
    Probability
FROM
    studentseda
WHERE
    Probability =(
    SELECT
        MAX(Probability)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the lowest in Algebra?
SELECT
    id,
    class,
    gender,
    Algebra
FROM
    studentseda
WHERE
    Algebra =(
    SELECT
        MIN(Algebra)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the lowest in Calculus1?
SELECT
    id,
    class,
    gender,
    Calculus1
FROM
    studentseda
WHERE
    Calculus1 =(
    SELECT
        MIN(Calculus1)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the lowest in Calculus2?
SELECT
    id,
    class,
    gender,
    Calculus2
FROM
    studentseda
WHERE
    Calculus2 =(
    SELECT
        MIN(Calculus2)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the lowest in Statistics?
SELECT
    id,
    class,
    gender,
    Statistics
FROM
    studentseda
WHERE
    Statistics =(
    SELECT
        MIN(Statistics)
    FROM
        studentseda
)
Delimiter
    //
    -- Who scored the lowest in Probability?
SELECT
    id,
    class,
    gender,
    Probability
FROM
    studentseda
WHERE
    Probability =(
    SELECT
        MIN(Probability)
    FROM
        studentseda
)
Delimiter
    //
    -- What is the average score of students in Algebra?
SELECT
    AVG(Algebra)
FROM
    studentseda
Delimiter
    //
    -- What is the average score of students in Calculus1?
SELECT
    AVG(Calculus1)
FROM
    studentseda
Delimiter
    //
    -- What is the average score of students in Calculus2?
SELECT
    AVG(Calculus2)
FROM
    studentseda
Delimiter
    //
    -- What is the average score of students in Statistics?
SELECT
    AVG(Statistics)
FROM
    studentseda
Delimiter
    //
    -- What is the average score of students in Probability?
SELECT
    AVG(Probability)
FROM
    studentseda
Delimiter
    //
    -- Who has the highest GPA?
SELECT
    ID,
    class,
    gender,
    GPA
FROM
    studentseda
WHERE
    gpa =(
    SELECT
        MAX(gpa)
    FROM
        studentseda
)
DELIMITER
    //
    -- Who has thelowest GPA?
SELECT
    ID,
    class,
    gender,
    GPA
FROM
    studentseda
WHERE
    gpa =(
    SELECT
        MIN(gpa)
    FROM
        studentseda
)
